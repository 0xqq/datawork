webpackJsonp([22],{"319A":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mask-edit-task-manage",attrs:{id:"mask"}},[a("div",{staticClass:"mask-content",attrs:{id:"mask-content"}},[a("div",{staticClass:"mask-main-title"},[a("span",[t._v("修改 Task")]),t._v(" "),a("i",{staticClass:"close-icon",on:{click:t.showHiddenEdittask}})]),t._v(" "),a("div",{staticClass:"info"},[a("el-form",{ref:"taskManageViewForm",staticClass:"taskManageViewForm",attrs:{model:t.taskAddViewModel,rules:t.taskEditViewModelRules,"label-width":"120px","auto-complete":"off"}},[a("el-form-item",{attrs:{label:"项目组名称",prop:"projectName"}},[a("el-input",{attrs:{disabled:!0,type:"text","auto-complete":"off"},model:{value:t.taskAddViewModel.projectName,callback:function(e){t.$set(t.taskAddViewModel,"projectName",e)},expression:"taskAddViewModel.projectName"}}),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Task归属的项目组，可选列表中一般包含多个项目组",placement:"right"}},[a("span",{staticClass:"el-icon-question info-icon"})])],1),t._v(" "),a("el-form-item",{attrs:{label:"应用名称",prop:"applyName"}},[a("el-input",{attrs:{disabled:!0,type:"text","auto-complete":"off",placeholder:""},model:{value:t.taskAddViewModel.applyName,callback:function(e){t.$set(t.taskAddViewModel,"applyName",e)},expression:"taskAddViewModel.applyName"}}),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Task归属的应用，可选列表中一般包含多个应用",placement:"right"}},[a("span",{staticClass:"el-icon-question info-icon"})])],1),t._v(" "),a("el-form-item",{attrs:{label:"HTTP_PATH",prop:"httpPath"}},[a("el-input",{attrs:{disabled:!0,type:"text","auto-complete":"off",placeholder:"请输入HTTP_PATH"},model:{value:t.taskAddViewModel.httpPath,callback:function(e){t.$set(t.taskAddViewModel,"httpPath",e)},expression:"taskAddViewModel.httpPath"}}),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Task的HTTP接口请求路径，示例：/example",placement:"right"}},[a("span",{staticClass:"el-icon-question info-icon"})])],1),t._v(" "),a("el-form-item",{staticClass:"radio-text",attrs:{label:"是否配置参数",prop:"isConfigParams"}},[a("el-radio-group",{model:{value:t.taskAddViewModel.isConfigParams,callback:function(e){t.$set(t.taskAddViewModel,"isConfigParams",e)},expression:"taskAddViewModel.isConfigParams"}},[a("el-radio",{attrs:{label:1}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:0}},[t._v("否")])],1),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"选择HTTP接口是否有入参",placement:"right"}},[a("span",{staticClass:"el-icon-question info-icon"})])],1),t._v(" "),a("el-form-item",{attrs:{label:"描述",prop:"taskdesc"}},[a("el-input",{attrs:{type:"textarea","auto-complete":"off",placeholder:""},model:{value:t.taskAddViewModel.taskdesc,callback:function(e){t.$set(t.taskAddViewModel,"taskdesc",e)},expression:"taskAddViewModel.taskdesc"}}),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"描述Task的功能",placement:"right"}},[a("span",{staticClass:"el-icon-question info-icon"})])],1),t._v(" "),a("el-form-item",{staticClass:"add-ip-post",attrs:{label:"ip：port",prop:"ipPost"}},[a("el-input",{class:{active:t.showIpPortError},attrs:{type:"text","auto-complete":"off",placeholder:""},model:{value:t.addIpPostVal,callback:function(e){t.addIpPostVal=e},expression:"addIpPostVal"}}),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"添加Task所在应用的IP地址与端口",placement:"right"}},[a("span",{staticClass:"el-icon-question info-icon"})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showIpPortError,expression:"showIpPortError"}],staticClass:"error-msg"},[t._v(t._s(t.ipPortErrorText))])],1),t._v(" "),a("el-button",{staticClass:"btn-small",attrs:{loading:t.loadingRefresh},on:{click:t.showHiddenEditIpPost}},[t._v("添加")])],1),t._v(" "),a("div",{staticClass:"ip-post"},t._l(t.taskAddViewModel.ipPost,function(e,s){return a("span",{key:s},[t._v(t._s(e)),a("i",{staticClass:"el-icon-error",on:{click:function(a){return t.handleClickDeleteIp(e)}}})])}),0),t._v(" "),a("div",{staticClass:"alert-button"},[a("el-button",{on:{click:t.showHiddenEdittask}},[t._v("取消")]),t._v(" "),a("el-button",{on:{click:t.showHiddenSave}},[t._v("修改")])],1)],1)])])},i=[],o={render:s,staticRenderFns:i};e.a=o},LkGx:function(t,e,a){var s=a("kxFB");e=t.exports=a("FZ+f")(!1),e.push([t.i,".mask-edit-task-manage{z-index:2000;background-color:rgba(17,37,90,.43);top:0;left:0;width:100%;height:100%;position:fixed}.mask-edit-task-manage .mask-content{width:730px;margin:0 auto;position:relative;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);-webkit-box-shadow:1px 1px 50px rgba(0,0,0,.3);box-shadow:1px 1px 50px rgba(0,0,0,.3);background:#fff url("+s(a("uSs+"))+") no-repeat center 100px}.mask-edit-task-manage .mask-content .mask-main-title{height:50px;background:#4669c7;color:#fff;font-size:24px;color:#333;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:left;padding-left:20px}.mask-edit-task-manage .mask-content .mask-main-title span{line-height:50px;color:#fff;font-size:16px}.mask-edit-task-manage .mask-content .mask-main-title .close-icon{width:16px;height:16px;float:right;background:url("+s(a("bE5C"))+') no-repeat;cursor:pointer;margin:16px 15px 0 0}.mask-edit-task-manage .mask-content .info{width:100%;height:auto;max-height:500px;margin:40px auto;padding:0 40px 20px;overflow:auto}.mask-edit-task-manage .mask-content .info .el-form{position:relative}.mask-edit-task-manage .mask-content .info .el-form .el-form-item .el-form-item__content{width:calc(100% - 200px)}.mask-edit-task-manage .mask-content .info .el-form .el-form-item .el-form-item__content .el-radio{line-height:38px}.mask-edit-task-manage .mask-content .info .el-form .el-form-item .pre-job-key-text{display:inline-block;width:120px;height:34px;line-height:34px;margin-right:3px;background-color:#f5f7fa;border:1px solid #e4e7ed;color:#c0c4cc;padding-left:10px}.mask-edit-task-manage .mask-content .info .el-form .el-input.active .el-input__inner{border:1px solid #f56c6c}.mask-edit-task-manage .mask-content .info .el-form .error-msg{position:absolute;bottom:-20px;left:0;font-size:10px;height:20px;line-height:20px;color:#f56c6c}.mask-edit-task-manage .mask-content .info .el-form .el-form-item.add-ip-post{position:relative;margin-bottom:2px}.mask-edit-task-manage .mask-content .info .el-form .el-form-item.add-ip-post .el-form-item__label:before{display:inline-block;content:"*";color:#f56c6c;margin-right:3px}.mask-edit-task-manage .mask-content .info .el-form .btn-small{position:absolute;right:24px;bottom:4px;border:1px solid #dedede;color:#333}.mask-edit-task-manage .mask-content .info .el-form .btn-small:hover{border:1px solid #dedede;background:rgba(169,180,218,.21);color:#333}.mask-edit-task-manage .mask-content .info .ip-post{margin:0 0 20px 120px;width:calc(100% - 235px)}.mask-edit-task-manage .mask-content .info .ip-post span{width:100%;height:28px;line-height:28px;font-size:12px;color:rgba(0,0,0,.65);display:inline-block;padding-left:10px;border:1px solid #d9d9d9;border-top:0}.mask-edit-task-manage .mask-content .info .ip-post span:first-child{border-top:1px solid #d9d9d9}.mask-edit-task-manage .mask-content .info .ip-post span i{float:right;font-style:normal;width:18px;height:18px;border-radius:100%;line-height:28px;margin-right:10px;text-align:center;font-size:10px;color:#d3d3d3;cursor:pointer}.mask-edit-task-manage .mask-content .info .ip-post span i:hover{color:#fa6056}',""])},bE5C:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAU9JREFUSMetkkuuAVEQhjGxARNLEe+Y0xEkQuikMROJBQgShMRyLIBlGImhoSbxrLqDv/sm3be4up2afOmc0+f765wKMDExLZfMzMyHA6jrAcWFcwcDcL8Hq1VrYbdjRz2foGGoEc/nLNZqZW3QNPB+l4N4vxHc7GIhi00TjMVcP5RKL4MQE1Oj8VnHk4ksPp/BbPaf5OWyHOTxwHq9Lv83nfoWy51UKr9idxBmZq7VwNlMmVgOouvOmbCL6I+TmJhOJ3yk077FchDDeCl2dJzJfHpuyFuMSAQMBuX1cBiMRhV3Phq979h9I7cbWCyqF9tvTExMqRTYaskzYgfRNI/i8djrcGG93X5/I4WCcrG3INcrmM+7xMOh/MamiQMTCX9P2O3KQS4XMJezNh6PsjiZ9D1EjiC9nhxks7E29Pvgeg3G49+K5SCdDrjdgs3mD9vTybFFj2NhAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTAzLTA0VDE1OjQyOjQwKzA4OjAw1ocA7gAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wMy0wNFQxNTo0Mjo0MCswODowMKfauFIAAABNdEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL2hvbWUvYWRtaW4vaWNvbi1mb250L3RtcC9pY29uX2RodDVmMmo0c212L3ppeXVhbmxkcGkuc3Znh2M/1AAAAABJRU5ErkJggg=="},ih47:function(t,e,a){var s=a("LkGx");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("463c8352",s,!0,{})},nnPC:function(t,e,a){"use strict";function s(t){a("ih47")}Object.defineProperty(e,"__esModule",{value:!0});var i=a("wbk4"),o=a("319A"),r=a("VU/8"),n=s,d=r(i.a,o.a,!1,n,null,null);e.default=d.exports},"uSs+":function(t,e,a){t.exports=a.p+"static/img/mark-bg.b868281.png"},wbk4:function(t,e,a){"use strict";e.a={name:"EditTaskTmpl",props:["editParamsSearch","editParamsInfo"],data:function(){var t=function(t,e,a){switch(t.field){case"httpPath":if(!new RegExp(/^\/([(a-zA-Z)+(0-9_)?]+\/?)+$/i).test(e))return a(new Error('HTTP_PATH格式必须以 " / "开头，其余字符可为英文、数字、下划线'));break;case"taskdesc":if(""!==e.replace(/(^\s*)|(\s*$)/g,"")&&!new RegExp(/^[^]{2,1000}$/).test(e))return a(new Error("输入内容必须是2到1000个字符!"))}a()};return{loadingRefresh:!1,addIpPostVal:"",taskAddViewModel:{projectName:"",applyName:"",httpPath:"",isConfigParams:"",taskdesc:"",ipPost:[]},showIpPortError:!1,ipPortErrorText:"",taskEditViewModelRules:{isConfigParams:[this.$validator.required("请选择是否配置参数")],taskdesc:[this.$validator.required("请输入描述内容"),{validator:t,trigger:"blur"}],httpPath:[this.$validator.required("请输入HTTP_PATH"),{validator:t,trigger:"blur"}]}}},created:function(){this.initData()},methods:{initData:function(){this.taskAddViewModel={projectName:this.editParamsInfo.taskGroupName,applyName:this.editParamsInfo.taskAppName,httpPath:this.editParamsInfo.taskAppHttpPath,isConfigParams:this.editParamsInfo.paramCount,taskdesc:this.editParamsInfo.taskDesc,ipPost:null!==this.editParamsInfo.taskAppIpPort&&void 0!==this.editParamsInfo.taskAppIpPort?this.editParamsInfo.taskAppIpPort.split(","):[]}},handleClickDeleteIp:function(t){var e=this,a=e.taskAddViewModel.ipPost.indexOf(t);-1!==a&&e.taskAddViewModel.ipPost.splice(a,a+1)},showHiddenEditIpPost:function(){var t=this,e=this;this.loadingRefresh=!0,e.$http.get(e.$api.getApiAddress("/taskapi/checkPingTelnet","CESHI_API_HOST"),{host:e.addIpPostVal}).then(function(a){switch(a.data.code){case 0:-1===e.taskAddViewModel.ipPost.indexOf(e.addIpPostVal)&&""!==e.addIpPostVal?(e.taskAddViewModel.ipPost.push(e.addIpPostVal),e.addIpPostVal="",t.ipPortErrorText="",t.showIpPortError=!1):""===e.addIpPostVal?(t.showIpPortError=!0,t.ipPortErrorText="ip：port不能为空"):(t.showIpPortError=!0,t.ipPortErrorText="ip：port已添加，请勿重复");break;default:t.showIpPortError=!0,t.ipPortErrorText="连通性失败"}t.loadingRefresh=!1}).catch(function(){t.loadingRefresh=!1,e.$message({message:"服务未响应！",type:"error"})})},showHiddenEdittask:function(){this.$emit("showHiddenEdittask",!1,this.editParamsSearch)},showHiddenSave:function(){var t=this,e={taskId:this.editParamsInfo.taskId,taskKey:this.editParamsInfo.taskKey,taskGroupName:this.editParamsInfo.taskGroupName,taskAppName:this.editParamsInfo.taskAppName,taskAppHttpPath:this.taskAddViewModel.httpPath,taskAppIpPort:t.taskAddViewModel.ipPost.join(","),taskDesc:t.taskAddViewModel.taskdesc,paramCount:this.taskAddViewModel.isConfigParams};if(0===t.taskAddViewModel.ipPost.length)return void t.$message({message:"请添加ip：port",type:"error"});var a={searchProjectName:this.editParamsInfo.taskGroupName,searchApplyName:this.editParamsInfo.taskAppName,searchTaskName:""};this.$refs.taskManageViewForm.validate(function(s){s&&t.$http.post(t.$api.getApiAddress("/taskapi/updateTask","CESHI_API_HOST"),e).then(function(e){switch(e.data.code){case 0:t.$message({message:"修改成功",type:"success"}),t.$emit("showHiddenEdittask",!1,a);break;default:t.$message({message:e.data.message,type:"error"}),t.$emit("showHiddenEdittask",!1,a)}}).catch(function(){t.$message({message:"修改失败",type:"error"}),t.$emit("showHiddenEdittask",!1,t.editParamsSearch)})})}}}}});